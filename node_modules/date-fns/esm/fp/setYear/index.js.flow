if(a==b)return B(b);var c=Ef();this.ra(c.promise);zra(this.$,this.La,a);this.refresh();Asa(this.ia,this.ja,a,u(function(){this.aa=null;c.resolve(a)},this),u(function(){zra(this.$,this.La,b);this.refresh();c.reject(null)},this));return this.aa=c.promise};g.Sz=function(){return this.aa};g.r6=function(){return this.ea?1:this.ha.ja.da?2:3};g.IU=function(){return BA(this.$,this.La).Hc};
var Bsa=function(a,b,c,d,e){y.call(this);this.ea=b;this.ra=c;this.La=d;this.ja=a.get(Hl).ob();this.$=this.ea.Me(this.La,this.ja);this.Ta=new D;this.Da(this.Ta);this.Ta.vd(e);this.ia=[];this.aa=[];this.ha={};this.da=null;this.refresh()};q(Bsa,y);g=Bsa.prototype;
g.refresh=function(){var a={},b=[],c=EA(BA(this.ea,this.La)),d=c.length-1!=Xb(this.ha);ma(this.ia);var e=ra(this.aa),f={};ma(this.aa);l(c,function(h){if(!h.Xc()){var k=!this.ha[h.ob()];d|=k;k&&b.push(h);a[h.ob()]=!0;this.ia.push(h);h.eu()&&(this.aa.push(h),f[h.ob()]=!0)}h.xa().vd(this.Ta)},this);e.length!=this.aa.length?d=!0:l(e,function(h){d|=!f[h.ob()]},this);Csa(this,this.aa);this.ha=a;this.$=this.$||this.ea.Me(this.La,this.ja);d&&this.Ta.dispatchEvent(new rpa(b))};g.xa=function(){return this.Ta};
g.Xl=function(a){return this.ea.Me(this.La,a)};g.getAll=function(a){var b=ra(this.ia);a&&this.$&&na(b,this.$);return b};g.dg=function(a){var b=ra(this.aa);a&&this.$&&na(b,this.$);return b};g.It=function(){return this.$};g.A_=function(){return BA(this.ea,this.La).Iw};g.search=function(a){a=a.replace("#"," ");this.da||(this.da=new Wx,Csa(this,this.aa));return this.da.search(a)};g.sga=function(a){var b=3;switch(a){case "t":b=1;break;case "e":b=2}Dsa(this.ra,this.ea.uc(this.La),b)};
var Csa=function(a,b){a.da&&(a.da.clear(),l(b,func